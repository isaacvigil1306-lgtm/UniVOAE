<div class="contenedor">
  <h1>Bienvenido, {{ estudiante }}!</h1>

  <!-- FORMULARIO DE DATOS DEL USUARIO -->
  <div *ngIf="modoEdicion" class="formulario-usuario">
    <h2>Perfil</h2>
    <form #form="ngForm" (ngSubmit)="guardarUsuario(form)">
      <div class="form-grid">
        <div class="form-group">
          <label>Nombre Completo</label>
          <input type="text" [(ngModel)]="usuario.nombre" name="nombre" required>
        </div>

        <div class="form-group">
          <label>N√∫mero de Cuenta</label>
          <input type="text" [(ngModel)]="usuario.numeroCuenta" name="numeroCuenta" required>
        </div>

        <div class="form-group">
          <label>Correo</label>
          <input type="email" [(ngModel)]="usuario.correo" name="correo" required>
        </div>

        <div class="form-group">
          <label>Tel√©fono</label>
          <input type="text" [(ngModel)]="usuario.telefono" name="telefono">
        </div>

        <div class="form-group">
          <label>Identidad</label>
          <input type="text" [(ngModel)]="usuario.identidad" name="identidad" required>
        </div>

        <div class="form-group">
          <label>Carrera</label>
          <select [(ngModel)]="usuario.carrera" name="carrera">
            <option value="Ingenieria en Informatica">Ingenier√≠a en Inform√°tica</option>
            <option value="Ingenieria Electronica">Ingenier√≠a Electr√≥nica</option>
            <option value="Ingenieria en Gestion y Logistica">Ingenier√≠a en Gesti√≥n y Log√≠stica</option>
            <option value="Otro">Otro</option>
          </select>
        </div>
      </div>

      <button type="submit" class="btn-actualizar">Guardar / Actualizar</button>
    </form>
  </div>

  <div *ngIf="!modoEdicion" class="card-usuario" >
  <h2>Perfil</h2>
  <div class="info-grid">
    <p><strong>Nombre:</strong> {{ usuario.nombre }}</p>
    <p><strong>N√∫mero de Cuenta:</strong> {{ usuario.numeroCuenta }}</p>

    <p><strong>Correo:</strong> {{ usuario.correo }}</p>
    <p><strong>Tel√©fono:</strong> {{ usuario.telefono }}</p>

    <p><strong>Identidad:</strong> {{ usuario.identidad }}</p>
    <p><strong>Carrera:</strong> {{ usuario.carrera }}</p>
  </div>
  <button class="btn-editar" (click)="editarUsuario()">Editar</button>
</div>

  <!-- Horas acumuladas -->
  <div class="resumen-horas">
    <div class="caja">
      <h3>Horas Acumuladas</h3>
      <p>{{ horasAcumuladas }} horas</p>
    </div>
    <div class="caja">
      <h3>Horas Pendientes</h3>
      <p>{{ horasPendientes }} horas</p>
    </div>
  </div>

<br><br>
  <!-- Actividades pr√≥ximas -->
  <div class="actividades">
  <h2>Actividades Pr√≥ximas</h2>

  <div class="tabla-wrapper">

  <div class="tabla-scroll">
    <table *ngIf="actividadesProximas.length > 0" class="tabla-actividades">
      <thead>
        <tr>
          <th>Actividad</th>
          <th>Fecha</th>
          <th>Lugar</th>
          <th>Acci√≥n</th>
          <th>Estado</th>
          <th>Pago</th>
        </tr>
      </thead>
      <tbody>
       <tr *ngFor="let act of actividadesProximas">
  <td>{{ act.nombre }}</td>
  <td>{{ act.fecha }}</td>
  <td>{{ act.lugar }}</td>
  <td>
    <button class="btn-cancelar" (click)="cancelarInscripcion(act.id!)">‚ùå Cancelar</button>

    <!-- Bot√≥n de pago solo si requiere pago -->
   
  </td>
  <td>{{ act.estadoInscripcion || 'pendiente' }}</td>
  <td> <button *ngIf="act.pago"
            class="btn-pago"
            (click)="abrirModalPago(act, usuario.nombre, usuario.numeroCuenta, usuario.correo)">
      Enviar comprobante
    </button></td>
</tr>

      </tbody>
    </table>
  </div>
</div>

  <p *ngIf="actividadesProximas.length === 0">
    No tienes actividades pr√≥ximas registradas.
  </p>
</div>
<!-- Modal de pago -->
<div class="modal" *ngIf="mostrarModalPago">
  <div class="modal-contenido">
    <button class="btn-cerrar-x" (click)="cerrarModalPago()">√ó</button>
    <h2>Informaci√≥n de Pago</h2>

    <div class="detalle" *ngIf="actividadPago">
      <p><strong>Actividad:</strong> {{ actividadPago.nombre }}</p>
      <p><strong>Precio:</strong> {{ actividadPago.precio }} Lps</p>
      <p><strong>Banco:</strong> {{ actividadPago.banco }}</p>
      <p><strong>N√∫mero de cuenta:</strong> {{ actividadPago.numeroCuenta }}</p>
    </div>

    <p class="nota">Realiza la transferencia y env√≠a el comprobante por correo:</p>

    <a [href]="mailtoLink()" class="btn-mail" target="_blank" rel="noopener">
      üìß Presione aqu√≠ para enviar su comprobante
    </a>
  </div>
</div>

</div>
